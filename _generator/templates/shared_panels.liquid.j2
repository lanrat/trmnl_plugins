<!-- Generated by _generator/generate.py -- DO NOT EDIT DIRECTLY -->
<style>
  .view {
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }

  .image-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px;
    overflow: hidden;
    min-height: 0; /* Important for flex children */
  }

  .image-container img {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain;
    display: block;
    border-radius: 5px;
  }

</style>

<script>
  /**
 * Parses an HTML string and returns the 'src' attribute of an <img> tag at the given index.
 * Supports negative indices (-1 = last image, -2 = second to last, etc).
 *
 * @param {string} htmlString The HTML string to parse.
 * @param {number} index The index of the image to extract (supports negative).
 * @returns {string | null} The URL from the image's 'src' attribute, or null if not found.
 */
  function getImageUrlFromString(htmlString, index) {
    try {
      const parser = new DOMParser();
      const doc = parser.parseFromString(htmlString, 'text/html');
      const imgs = doc.querySelectorAll('img');
      if (imgs.length === 0) {
        console.warn("No <img> tags found in the provided string.");
        return null;
      }
      const i = index < 0 ? imgs.length + index : index;
      if (i < 0 || i >= imgs.length) {
        console.warn("Image index " + index + " out of range (found " + imgs.length + " images).");
        return null;
      }
      return imgs[i].getAttribute('src');
    } catch (error) {
      console.error("Error parsing HTML string:", error);
      return null;
    }
  }

  function displayImg(htmlString) {
    const imgElement = document.getElementById('comic-image');
    const newUrl = getImageUrlFromString(htmlString, << comic.panel_index >>);
    if (newUrl) {
      imgElement.src = newUrl;
    } else {
      imgElement.alt = "Could not load comic.";
      console.error("Could not extract image URL.");
    }
  }
</script>
{% template comic %}
<div class="view bg-white">
  <div class="image-container">
    {% if item %}
    <img id="comic-image" class="image image-dither" />
    <script>displayImg({{ item.description | json }});</script>
    {% else %}
    <p class="text--black">Error Loading Image</p>
    {% endif %}
  </div>
</div>
{% endtemplate %}